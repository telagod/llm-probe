# LLM Probe

<p align="center">
  <img src="web/public/favicon.svg" width="80" alt="LLM Probe Logo" />
</p>

<p align="center">
  <strong>LLM API ç«¯ç‚¹çœŸä¼ªæ£€æµ‹ Â· åè®®åˆè§„éªŒè¯ Â· æ³¨å…¥æŠ—æ€§è¯„ä¼° Â· å¤šç»´ä¿¡ä»»è¯„åˆ†</strong>
</p>

<p align="center">
  <a href="#åŠŸèƒ½">åŠŸèƒ½</a> Â·
  <a href="#å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> Â·
  <a href="#web-æ§åˆ¶å°">Web æ§åˆ¶å°</a> Â·
  <a href="#æµ‹è¯•å¥—ä»¶">æµ‹è¯•å¥—ä»¶</a> Â·
  <a href="#ä¿¡ä»»è¯„åˆ†">ä¿¡ä»»è¯„åˆ†</a> Â·
  <a href="ROADMAP.md">Roadmap</a>
</p>

---

## è¿™æ˜¯ä»€ä¹ˆï¼Ÿ

LLM Probe æ˜¯ä¸€ä¸ªå¼€æºçš„ LLM API ç«¯ç‚¹æ£€æµ‹æ¡†æ¶ã€‚å½“ä½ ä½¿ç”¨ç¬¬ä¸‰æ–¹ API ä»£ç†ã€é•œåƒç«™æˆ–è‡ªå»ºç½‘å…³æ—¶ï¼Œä½ å¦‚ä½•ç¡®è®¤èƒŒåè·‘çš„çœŸçš„æ˜¯ä½ ä»˜è´¹çš„é‚£ä¸ªæ¨¡å‹ï¼Ÿ

LLM Probe é€šè¿‡**åè®®æŒ‡çº¹ã€è¡Œä¸ºæ¢é’ˆã€æ¨ç†èƒ½åŠ›è¯„ä¼°ã€æ³¨å…¥æŠ—æ€§æµ‹è¯•**ç­‰å¤šç»´åº¦æ£€æµ‹ï¼Œç”Ÿæˆä¸€ä¸ªé‡åŒ–çš„**ä¿¡ä»»è¯„åˆ†**ï¼Œå¸®ä½ è¯†åˆ«ï¼š

- ğŸ­ **æ¨¡å‹æ›¿æ¢** â€” ç”¨ä¾¿å®œæ¨¡å‹å†’å……è´µæ¨¡å‹
- ğŸ”€ **åè®®ç¯¡æ”¹** â€” ä¿®æ”¹/ä¸¢å¼ƒ API å‚æ•°ã€ç¼“å­˜ã€å·¥å…·è°ƒç”¨
- ğŸ’‰ **æ³¨å…¥é£é™©** â€” ä¸­é—´å±‚æ³¨å…¥ç³»ç»Ÿæç¤ºã€æ³„éœ²å†…éƒ¨ä¿¡æ¯
- ğŸ“‰ **èƒ½åŠ›é™çº§** â€” æ¨ç†èƒ½åŠ›ã€ä¸€è‡´æ€§ä½äºå®˜æ–¹åŸºçº¿

## åŠŸèƒ½

| ç»´åº¦ | æ£€æµ‹å†…å®¹ |
|------|----------|
| åè®®åˆè§„ | Messages API å‚æ•°è¦†ç›–ã€ç¼“å­˜è¯»å†™ã€å·¥å…·è°ƒç”¨é“¾è·¯ã€SSE æµå¼äº‹ä»¶åºåˆ— |
| çœŸä¼ªè¯†åˆ« | åè®®æŒ‡çº¹é˜²ä¼ªã€æ¨¡å‹ ID æ ¡éªŒã€éšè—å·¥å…·æ³¨å…¥æ¢é’ˆã€ä¸€è‡´æ€§æ¼‚ç§»æ£€æµ‹ |
| æ³¨å…¥æŠ—æ€§ | ç›´æ¥è¦†ç›–æ”»å‡»ã€é—´æ¥ tool-result æ³¨å…¥ã€allowlist é€ƒé€¸ã€ä¿¡æ¯æ³„æ¼æ¢é’ˆ |
| æ¨ç†è¯„ä¼° | å¤šé¢†åŸŸé¢˜åº“ï¼ˆåŒ»å­¦/æ³•å¾‹/é‡‘è/å®‰å…¨/æ¶æ„/SREï¼‰ã€è¯­ä¹‰ç­‰ä»·åˆ¤åˆ†ã€å¤–éƒ¨ benchmark å¯¼å…¥ |
| è¾¹ç•Œæ¢æµ‹ | é•¿æ–‡æœ¬ needle-in-haystackã€payload ä½“ç§¯äºŒåˆ†é€¼è¿‘ |
| è¶‹åŠ¿åˆ†æ | è·¨æ—¶é—´ baseline å›å½’æ¼‚ç§»å‘Šè­¦ã€P95/slope/change-point è¶‹åŠ¿ |
| ä¿¡ä»»è¯„åˆ† | åŠ æƒå¤šç»´åº¦è¯„åˆ† + Hard-Gate å®‰å…¨é—¨æ§ï¼Œä¸€ç¥¨å¦å†³æœºåˆ¶ |

## å¿«é€Ÿå¼€å§‹

### CLI æ¢é’ˆ

```bash
# æ„å»º
go build ./cmd/claude-probe

# è¿è¡Œï¼ˆå½“å‰æ”¯æŒ Anthropic Messages API å…¼å®¹ç«¯ç‚¹ï¼‰
export CLAUDE_BASE_URL="https://your-api-endpoint.com"
export CLAUDE_API_KEY="your_key"
export CLAUDE_MODEL="claude-sonnet-4-5-20250929"

go run ./cmd/claude-probe -suite all
```

æŒ‡å®šå¥—ä»¶ï¼š

```bash
go run ./cmd/claude-probe -suite stream,error,authenticity,injection
```

è¾“å‡º JSON æŠ¥å‘Šï¼š

```bash
go run ./cmd/claude-probe -suite all -format json -out report.json
```

### Web æ§åˆ¶å°

```bash
# 1. å¯åŠ¨ API æœåŠ¡
cp ./configs/server.example.yaml ./configs/server.local.yaml
# ç¼–è¾‘ server.local.yamlï¼šå¡«å…¥ key æ± é…ç½®
go run ./cmd/probe-api -config ./configs/server.local.yaml

# 2. å¯åŠ¨å‰ç«¯
cd web && npm install && npm run dev
```

- å…ç™»å½•å¿«æ£€ï¼š`http://localhost:5173/user`
- ç®¡ç†åå°ï¼š`http://localhost:5173/admin`ï¼ˆéœ€ OIDC ç™»å½•ï¼‰

## æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Web æ§åˆ¶å°                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç”¨æˆ·å¿«æ£€ UI  â”‚  â”‚       ç®¡ç†åå° (OIDC)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                         â”‚                   â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                      â–¼                                â”‚
â”‚              API Server (Go)                          â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    â”‚ Router Â· Auth Â· Budget Â· Store  â”‚                â”‚
â”‚    â”‚ Run Queue Â· SSE Â· OTel Tracing  â”‚                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                   â–¼                                   â”‚
â”‚           Probe Engine (Go)                           â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    â”‚  Runner Â· Suites Â· Scoring      â”‚                â”‚
â”‚    â”‚  Forensics Â· Regression         â”‚                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                   â–¼                                   â”‚
â”‚          Target LLM API Endpoint                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æµ‹è¯•å¥—ä»¶

| å¥—ä»¶ | è¯´æ˜ | æˆæœ¬ |
|------|------|------|
| `params` | Messages API å‚æ•°è¦†ç›–éªŒè¯ | ä½ |
| `cache` | Prompt Caching è¯»å†™ + å‰ç¼€å˜å¼‚ | ä½ |
| `tools` | å¤šå·¥å…·å¤šè½® tool_use/tool_result é“¾è·¯ | ä¸­ |
| `toolchoice` | tool_choice è¯­ä¹‰ä¸€è‡´æ€§ | ä½ |
| `stream` | SSE äº‹ä»¶åºåˆ—ä¸ç»“æ„éªŒè¯ | ä½ |
| `error` | é”™è¯¯è¯­ä¹‰ä¸ envelope å¥‘çº¦ | ä½ |
| `authenticity` | åè®®æŒ‡çº¹é˜²ä¼ª + éšè—å·¥å…·æ¢é’ˆ | ä¸­ |
| `reasoning` | å¤šé¢†åŸŸæ¨ç†é¢˜åº“ + è¯­ä¹‰ç­‰ä»·åˆ¤åˆ† | ä¸­ |
| `injection` | ç›´æ¥/é—´æ¥æ³¨å…¥ + allowlist é€ƒé€¸ | ä¸­ |
| `needle` | é•¿æ–‡æœ¬ needle-in-haystack | **é«˜** |
| `block` | Payload ä½“ç§¯äºŒåˆ†è¾¹ç•Œæ¢æµ‹ | **é«˜** |
| `regression` | è·¨æ—¶é—´ baseline æ¼‚ç§»å‘Šè­¦ | â€” |
| `timeline` | P95/slope/change-point è¶‹åŠ¿ | â€” |

## ä¿¡ä»»è¯„åˆ†

LLM Probe ç”Ÿæˆä¸€ä¸ª 0-100 çš„**ä¿¡ä»»è¯„åˆ†**ï¼Œç”±ä¸¤å±‚æœºåˆ¶ç»„æˆï¼š

**åŠ æƒè¯„åˆ†**ï¼šå„ç»´åº¦æŒ‰æƒé‡æ±‡æ€»ï¼ˆauthenticity 30%ã€injection 25%ã€tools 15%ã€toolchoice 10%ã€stream 10%ã€error 10%ï¼‰

**Hard-Gate ä¸€ç¥¨å¦å†³**ï¼šä»¥ä¸‹ä¿¡å·å‘½ä¸­ä»»ä¸€é¡¹ï¼Œç›´æ¥åˆ¤å®š failï¼Œæ— è§†åŠ æƒåˆ†ï¼š
- Spoof risk score > 70
- Injection leak count > 0
- éšè—å·¥å…·ä¿¡å·æ£€å‡º
- æœªçŸ¥å·¥å…·è°ƒç”¨æ£€å‡º
- ä¸€è‡´æ€§æ¼‚ç§»è¶…é˜ˆå€¼

```
Trust Score: 87.3 / 100  âœ“ PASS
Hard-Gate:   0 hits      âœ“ CLEAR
Decision:    TRUSTED
```

## å¯è§‚æµ‹æ€§

```bash
cd deploy/otel && docker compose up -d
# Jaeger UI: http://localhost:16686
```

æ‰€æœ‰ probe æ‰§è¡Œè‡ªåŠ¨ä¸ŠæŠ¥ OpenTelemetry tracesã€‚

## API æ¥å£

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | è®¤è¯ |
|------|------|------|------|
| POST | `/api/v1/admin/runs` | åˆ›å»ºæµ‹è¯•ä»»åŠ¡ | OIDC |
| GET | `/api/v1/admin/runs/{id}` | ä»»åŠ¡è¯¦æƒ… | OIDC |
| GET | `/api/v1/admin/runs/{id}/events` | SSE äº‹ä»¶æµ | OIDC |
| GET | `/api/v1/admin/metrics/overview` | æ¦‚è§ˆæŒ‡æ ‡ | OIDC |
| POST | `/api/v1/user/quick-test` | å…ç™»å½•å¿«æ£€ | é™æµ |
| GET | `/api/v1/user/quick-test/{id}` | å¿«æ£€ç»“æœï¼ˆè„±æ•ï¼‰ | é™æµ |

## å®‰å…¨è®¾è®¡

- **å‰ç«¯é›¶æ¥è§¦ API Key** â€” æ‰€æœ‰æ¨¡å‹è°ƒç”¨åœ¨æœåŠ¡ç«¯æ‰§è¡Œ
- **Key æ± é™é¢** â€” æ”¯æŒ daily_limit_usd / RPM / TPM
- **å®¡è®¡æ—¥å¿—** â€” æ¯æ¬¡ run è®°å½• key_usageã€é£é™©å¿«ç…§
- **Injection æ¢é’ˆä½¿ç”¨éšæœº sentinel** â€” ä¸ä¼šè¾“å‡ºçœŸå®å¯†é’¥

## å¼€å‘

```bash
# åç«¯æµ‹è¯•
go test ./...

# å‰ç«¯å¼€å‘
cd web && npm run dev

# å‰ç«¯æ„å»º
cd web && npm run build

# å†’çƒŸæµ‹è¯•
./scripts/smoke_api.sh
```

## License

MIT

---

<p align="center">
  <sub>Built for trust. Because you deserve to know what's behind the API.</sub>
</p>
